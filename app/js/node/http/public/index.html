<html>
<body>

<div>
    <div>
        <label>Number of images : </label>
        <select onchange="onImageNumberChange(this)">
            <option value="10" selected="selected">10</option>
            <option value="25">25</option>
            <option value="100">100</option>
        </select>
    </div>
    <div>
        <label>Refresh rate : </label>
        <select onchange="onRefreshRateChange(this)">
            <option value="5">5</option>
            <option value="10" selected="selected">10</option>
            <option value="60">60</option>
        </select>
        s
    </div>
</div>

<div style="display: flex; flex-wrap: wrap">

    <div id="container"/>


</div>
<script>


    let imageCount = 10;
    let refreshRate = 10;
    let timeout;

    function repaint(){
        console.log('repainting');
        let innerHtml = '';
        for(let i=0; i<imageCount; i++){
            const randomCount = Math.round(Math.random() * 21);
            const randomDisableCache = Math.round(Math.random() * 100000);
            innerHtml += `<img src="/random?preset=${randomCount}&width=100&height=100&random=${randomDisableCache}" style="width: 100px; height: 100px; margin: 3px; background-color: #3F51B5"/>`
        }
        document.getElementById("container").innerHTML = innerHtml;
    }



    function onImageNumberChange(event){
        imageCount = event.value;
        repaint();
    }
    function onRefreshRateChange(event){
        clearTimeout(timeout);
        refreshRate = event.value;
        restartTimeout();
    }

    function restartTimeout(){
        timeout = setTimeout(()=>{
            repaint();
            restartTimeout();
        }, refreshRate * 1000);
    }


    repaint();
    restartTimeout();

</script>
</body>
</html>
